<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–†–æ–∑—ã–≥—Ä—ã—à –≤ Telegram</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      background: var(--tg-theme-bg-color, #23272e);
      color: var(--tg-theme-text-color, #fff);
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      transition: background 0.3s;
    }
    .container {
      background: rgba(40,44,52,0.95);
      border-radius: 24px;
      padding: 32px 24px;
      box-shadow: 0 6px 32px 0 rgba(0,0,0,0.25);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 320px;
      max-width: 360px;
      margin: 24px 0;
      animation: showUp 0.7s cubic-bezier(.21,2,.56,.83);
    }
    @keyframes showUp {
      0% { transform: scale(0.9) translateY(40px); opacity:0; }
      100% { transform: scale(1) translateY(0); opacity:1; }
    }
    .dice {
      font-size: 72px;
      margin-bottom: 18px;
      animation: diceSpin 0.9s cubic-bezier(.21,2,.56,.83);
    }
    @keyframes diceSpin {
      0% { transform: rotate(-120deg) scale(0.6);}
      100% { transform: rotate(0) scale(1);}
    }
    .status-success { color: #60db7b; }
    .status-error { color: #ff5656; }
    .channels-list {
      margin: 18px 0 24px;
      width: 100%;
    }
    .channels-list li {
      margin-bottom: 6px;
      font-size: 1.05em;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .channels-list .status {
      font-size: 1em;
    }
    button {
      background: #5f8fff;
      color: #fff;
      border: none;
      border-radius: 12px;
      padding: 14px 0;
      width: 100%;
      font-size: 1.08em;
      cursor: pointer;
      box-shadow: 0 1px 5px rgba(0,0,0,0.12);
      margin-top: 12px;
      transition: background 0.2s;
    }
    button:active {
      background: #3867d6;
    }
    .subtitle {
      color: var(--tg-theme-hint-color, #bcbcbc);
      font-size: 1em;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <div class="container" id="main">
    <div class="dice">üé≤</div>
    <div id="status-text" class="subtitle">–ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ –∫–∞–Ω–∞–ª—ã...</div>
    <ul class="channels-list" id="channels"></ul>
    <button id="check-btn" style="display:none;">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–Ω–æ–≤–∞</button>
    <button id="participate-btn" style="display:none;">–£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å</button>
  </div>
  <script>
    // –ü—Ä–∏–º–µ—Ä: –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç –±–æ—Ç–∞ (initData, –∫–∞–Ω–∞–ª—ã, —Å—Ç–∞—Ç—É—Å)
    const tg = window.Telegram.WebApp;
    tg.ready();

    // –î–ª—è —Ç–µ—Å—Ç–∞. –í –ø—Ä–æ–¥–µ ‚Äî –ø–æ–ª—É—á–∞–π —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ initData / fetch —Å backend
    let channels = [
      {title: '–ö–∞–Ω–∞–ª 1', username: 'testchannel1', subscribed: false},
      {title: '–ö–∞–Ω–∞–ª 2', username: 'testchannel2', subscribed: true},
    ];

    // –ò–º–∏—Ç–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (–∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π fetch)
    function renderChannels(channels) {
      const ul = document.getElementById('channels');
      ul.innerHTML = '';
      channels.forEach(ch => {
        ul.innerHTML += `
          <li>
            <span class="status">${ch.subscribed ? '‚úÖ' : '‚ùå'}</span>
            <a href="https://t.me/${ch.username}" target="_blank">${ch.title}</a>
          </li>
        `;
      });
    }

    function showStatus(text, ok=false) {
      const s = document.getElementById('status-text');
      s.textContent = text;
      s.className = 'subtitle ' + (ok ? 'status-success' : 'status-error');
    }

    function updateUI() {
      renderChannels(channels);
      const all = channels.every(c=>c.subscribed);
      document.getElementById('participate-btn').style.display = all ? '' : 'none';
      document.getElementById('check-btn').style.display = all ? 'none' : '';
      showStatus(all ? 'üéâ –í—Å–µ —É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã! –ú–æ–∂–Ω–æ —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å.' : '‚ùó –í—ã –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –≤—Å–µ –∫–∞–Ω–∞–ª—ã.');
    }

    document.getElementById('check-btn').onclick = () => {
      // todo: —Å–¥–µ–ª–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ fetch –Ω–∞ —Ç–≤–æ–π backend
      // channels = ...
      updateUI();
      tg.HapticFeedback.notificationOccurred("warning");
    };

    document.getElementById('participate-btn').onclick = () => {
      showStatus('ü•≥ –¢–µ–ø–µ—Ä—å –≤—ã —É—á–∞—Å—Ç–≤—É–µ—Ç–µ –≤ —Ä–æ–∑—ã–≥—Ä—ã—à–µ!', true);
      tg.HapticFeedback.notificationOccurred("success");
      // tg.sendData('join') // –≤ –ø—Ä–æ–¥–µ: –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä—É!
    };

    // –°—Ç–∞—Ä—Ç–æ–≤–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞
    updateUI();
  </script>
</body>
</html>
