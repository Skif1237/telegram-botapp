<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–†–æ–∑—ã–≥—Ä—ã—à ‚Äì –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <style>
    body {
      background: #2b2d33;
      min-height: 100vh;
      margin: 0;
      font-family: 'Inter', Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .centerbox {
      background: #27282e;
      border-radius: 24px;
      box-shadow: 0 6px 48px #0007;
      padding: 40px 40px 30px;
      min-width: 350px;
      max-width: 95vw;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      animation: fadein .8s cubic-bezier(.2,.7,.3,1);
    }
    @keyframes fadein { from {opacity: 0; transform: translateY(50px);} to {opacity: 1; transform: none;} }
    .cube-anim {
      width: 68px; height: 68px; margin-bottom: 6px;
      transition: transform .25s;
    }
    .cube-anim.spin { animation: spin 1s linear infinite; }
    @keyframes spin { 100% { transform: rotate(1turn); } }
    .msg-error {
      color: #ff5555; font-size: 1.1em;
      margin-bottom: 6px; text-align: center;
    }
    .msg-success {
      color: #50fa7b; font-size: 1.13em;
      margin-bottom: 6px; text-align: center;
    }
    .channels-list {
      width: 100%; margin: 0 0 12px;
    }
    .channel-row {
      display: flex; align-items: center; gap: 9px;
      margin: 6px 0; font-size: 1.08em;
    }
    .channel-row .chan-status {
      font-size: 1.26em; width: 22px; display: inline-block; text-align: center;
    }
    .channel-row .chan-link {
      color: #82aaff; text-decoration: none;
      transition: color .15s;
    }
    .channel-row .chan-link:hover { color: #e0e0ff; }
    .retry-btn, .close-btn {
      margin-top: 16px;
      width: 100%; max-width: 300px;
      padding: 13px 0; border: none; border-radius: 9px;
      background: #6699ff; color: #fff; font-size: 1.1em; font-weight: 600;
      cursor: pointer; box-shadow: 0 2px 16px #0002;
      transition: background .15s;
    }
    .retry-btn:active { background: #3366cc; }
    .close-btn { background: #444b; margin-top: 10px;}
    .close-btn:active { background: #222a; }
    @media (max-width: 600px) {
      .centerbox { padding: 18px 4vw 20px; min-width: 0; }
      .retry-btn, .close-btn { font-size: 1em; }
    }
  </style>
</head>
<body>
  <div class="centerbox" id="box">
    <img src="https://cdn-icons-png.flaticon.com/512/2983/2983817.png" width="68" height="68" id="cubeimg" class="cube-anim" alt="–ö—É–±–∏–∫" />
    <div id="msg" class="msg-error">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.</div>
    <div class="channels-list" id="channels"></div>
    <button class="retry-btn" id="retrybtn" onclick="retryCheck()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–Ω–æ–≤–∞</button>
    <button class="close-btn" id="closebtn" style="display:none;" onclick="window.Telegram?.WebApp?.close()">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
  <script>
    // --- DEMO DATA: —Å—Ç–∞—Ç—É—Å—ã –∫–∞–Ω–∞–ª–æ–≤ (–∏–º–∏—Ç–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –æ—Ç –±—ç–∫–∞) ---
    const channels = [
      {title: '–ö–∞–Ω–∞–ª 1', url: 'https://t.me/test_bots_my', subscribed: false},
      {title: '–ö–∞–Ω–∞–ª 2', url: 'https://t.me/example2', subscribed: true},
      {title: '–ö–∞–Ω–∞–ª 3', url: 'https://t.me/example3', subscribed: true}
    ];
    // --- –§–£–ù–ö–¶–ò–Ø –ü–ï–†–ï–ü–†–û–í–ï–†–ö–ò (–∏–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏/–ø—Ä–æ–≤–µ—Ä–∫–∏) ---
    async function retryCheck() {
      showSpinner();
      // –°–∏–º—É–ª—è—Ü–∏—è ‚Äú–∑–∞–ø—Ä–æ—Å–∞‚Äù (1.2s)
      setTimeout(() => {
        // –°—é–¥–∞ –ø–æ—Ç–æ–º –±—É–¥–µ—Ç AJAX –∫ —Å–µ—Ä–≤–µ—Ä—É/–±–æ—Ç—É
        renderChannels(channels); // demo
      }, 1200);
    }
    // --- –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –ö–ê–ù–ê–õ–û–í –ò –°–¢–ê–¢–£–°–ê ---
    function renderChannels(data) {
      const notSubs = data.filter(ch => !ch.subscribed);
      let html = data.map(ch =>
        `<div class="channel-row">
          <span class="chan-status">${ch.subscribed ? '‚úÖ' : '‚ùå'}</span>
          <a href="${ch.url}" class="chan-link" target="_blank">${ch.title}</a>
        </div>`
      ).join('');
      document.getElementById('channels').innerHTML = html;
      let msg = '';
      let isSuccess = false;
      if (data.length && notSubs.length === 0) {
        msg = 'üéâ –¢–µ–ø–µ—Ä—å –≤—ã —É—á–∞—Å—Ç–≤—É–µ—Ç–µ –≤ —Ä–æ–∑—ã–≥—Ä—ã—à–µ!';
        isSuccess = true;
      } else {
        msg = '‚ùó–í—ã –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –≤—Å–µ –∫–∞–Ω–∞–ª—ã, –ø–µ—Ä–µ—á–∏—Ç–∞–π—Ç–µ —É—Å–ª–æ–≤–∏—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞!';
      }
      document.getElementById('msg').textContent = msg;
      document.getElementById('msg').className = isSuccess ? 'msg-success' : 'msg-error';
      document.getElementById('closebtn').style.display = isSuccess ? '' : 'none';
    }
    function showSpinner() {
      document.getElementById('msg').textContent = "–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏...";
      document.getElementById('msg').className = "msg-error";
      document.getElementById('channels').innerHTML = "";
      const img = document.getElementById('cubeimg');
      img.classList.add('spin');
      setTimeout(()=>img.classList.remove('spin'), 900); // demo –≤—Ä–∞—â–µ–Ω–∏–µ
    }
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏:
    window.onload = () => { renderChannels(channels); };
  </script>
</body>
</html>

